// This file is automatically generated by Keystone, do not modify it manually.
// Modify your Keystone config when you want to change this.

datasource postgresql {
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
  provider          = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                       Int         @id @default(autoincrement())
  name                     String      @default("")
  email                    String      @unique @default("")
  password                 String
  role                     String
  isProtected              Boolean     @default(false)
  passwordUpdatedAt        DateTime?   @default(now())
  mustChangePassword       Boolean     @default(false)
  from_Category_createdBy  Category[]  @relation("Category_createdBy")
  from_Category_updatedBy  Category[]  @relation("Category_updatedBy")
  from_Comment_createdBy   Comment[]   @relation("Comment_createdBy")
  from_Comment_updatedBy   Comment[]   @relation("Comment_updatedBy")
  from_Story_createdBy     Story[]     @relation("Story_createdBy")
  from_Story_updatedBy     Story[]     @relation("Story_updatedBy")
  from_StoryType_createdBy StoryType[] @relation("StoryType_createdBy")
  from_StoryType_updatedBy StoryType[] @relation("StoryType_updatedBy")
  from_Tag_createdBy       Tag[]       @relation("Tag_createdBy")
  from_Tag_updatedBy       Tag[]       @relation("Tag_updatedBy")
  from_Member_createdBy    Member[]    @relation("Member_createdBy")
  from_Member_updatedBy    Member[]    @relation("Member_updatedBy")
  from_Photo_createdBy     Photo[]     @relation("Photo_createdBy")
  from_Photo_updatedBy     Photo[]     @relation("Photo_updatedBy")
}

model Category {
  id                             Int       @id @default(autoincrement())
  title                          String    @default("")
  slug                           String    @default("")
  summary                        String    @default("")
  priority                       Int       @default(0)
  createdAt                      DateTime?
  updatedAt                      DateTime?
  createdBy                      User?     @relation("Category_createdBy", fields: [createdById], references: [id])
  createdById                    Int?      @map("createdBy")
  updatedBy                      User?     @relation("Category_updatedBy", fields: [updatedById], references: [id])
  updatedById                    Int?      @map("updatedBy")
  from_Story_category            Story[]   @relation("Story_category")
  from_Member_following_category Member[]  @relation("Member_following_category")

  @@index([createdById])
  @@index([updatedById])
}

model Comment {
  id                  Int       @id @default(autoincrement())
  member              Member?   @relation("Comment_member", fields: [memberId], references: [id])
  memberId            Int?      @map("member")
  story               Story?    @relation("Comment_story", fields: [storyId], references: [id])
  storyId             Int?      @map("story")
  content             String    @default("")
  parent              Comment?  @relation("Comment_parent", fields: [parentId], references: [id])
  parentId            Int?      @map("parent")
  root                Comment?  @relation("Comment_root", fields: [rootId], references: [id])
  rootId              Int?      @map("root")
  like                Member[]  @relation("Comment_like")
  state               String?   @default("public")
  published_date      DateTime?
  is_edited           Boolean   @default(false)
  is_active           Boolean   @default(true)
  createdAt           DateTime?
  updatedAt           DateTime?
  createdBy           User?     @relation("Comment_createdBy", fields: [createdById], references: [id])
  createdById         Int?      @map("createdBy")
  updatedBy           User?     @relation("Comment_updatedBy", fields: [updatedById], references: [id])
  updatedById         Int?      @map("updatedBy")
  from_Comment_parent Comment[] @relation("Comment_parent")
  from_Comment_root   Comment[] @relation("Comment_root")

  @@index([memberId])
  @@index([storyId])
  @@index([parentId])
  @@index([rootId])
  @@index([createdById])
  @@index([updatedById])
}

model Story {
  id                 Int                    @id @default(autoincrement())
  title              String                 @default("")
  url                String                 @unique @default("")
  summary            String                 @default("")
  content            String                 @default("")
  trimContent        String                 @default("")
  writer             String                 @default("")
  apiData            Json?
  trimApiData        Json?
  author             Member?                @relation("Story_author", fields: [authorId], references: [id])
  authorId           Int?                   @map("author")
  category           Category?              @relation("Story_category", fields: [categoryId], references: [id])
  categoryId         Int?                   @map("category")
  comment            Comment[]              @relation("Comment_story")
  related            Story[]                @relation("Story_related")
  published_date     DateTime?
  og_title           String                 @default("")
  og_image           String                 @default("")
  og_description     String                 @default("")
  full_content       Boolean                @default(false)
  paywall            Boolean                @default(false)
  isMember           Boolean                @default(false)
  origid             String                 @default("")
  full_screen_ad     StoryFullScreenAdType? @default(none)
  is_active          Boolean                @default(true)
  tag                Tag[]                  @relation("Story_tag")
  story_type         StoryStoryTypeType?    @default(story)
  createdAt          DateTime?
  updatedAt          DateTime?
  createdBy          User?                  @relation("Story_createdBy", fields: [createdById], references: [id])
  createdById        Int?                   @map("createdBy")
  updatedBy          User?                  @relation("Story_updatedBy", fields: [updatedById], references: [id])
  updatedById        Int?                   @map("updatedBy")
  from_Story_related Story[]                @relation("Story_related")

  @@index([authorId])
  @@index([categoryId])
  @@index([story_type])
  @@index([createdById])
  @@index([updatedById])
}

model StoryType {
  id          Int       @id @default(autoincrement())
  name        String    @unique @default("")
  createdAt   DateTime?
  updatedAt   DateTime?
  createdBy   User?     @relation("StoryType_createdBy", fields: [createdById], references: [id])
  createdById Int?      @map("createdBy")
  updatedBy   User?     @relation("StoryType_updatedBy", fields: [updatedById], references: [id])
  updatedById Int?      @map("updatedBy")

  @@index([createdById])
  @@index([updatedById])
}

model Tag {
  id          Int       @id @default(autoincrement())
  name        String    @unique @default("")
  story       Story[]   @relation("Story_tag")
  createdAt   DateTime?
  updatedAt   DateTime?
  createdBy   User?     @relation("Tag_createdBy", fields: [createdById], references: [id])
  createdById Int?      @map("createdBy")
  updatedBy   User?     @relation("Tag_updatedBy", fields: [updatedById], references: [id])
  updatedById Int?      @map("updatedBy")

  @@index([createdById])
  @@index([updatedById])
}

model Member {
  id                 Int                 @id @default(autoincrement())
  firebaseId         String              @unique @default("")
  customId           String              @unique @default("")
  name               String              @default("")
  nickname           String              @default("")
  avatar             String              @default("")
  intro              String              @default("")
  avatar_image       Photo?              @relation("Member_avatar_image", fields: [avatar_imageId], references: [id])
  avatar_imageId     Int?                @map("avatar_image")
  wallet             String              @default("")
  email              String              @unique @default("")
  is_active          Boolean             @default(true)
  verified           Boolean             @default(false)
  comment            Comment[]           @relation("Comment_member")
  member_like        Comment[]           @relation("Comment_like")
  follower           Member[]            @relation("Member_follower")
  following          Member[]            @relation("Member_follower")
  block              Member[]            @relation("Member_block")
  blocked            Member[]            @relation("Member_block")
  following_category Category[]          @relation("Member_following_category")
  balance            Int?                @default(0)
  language           MemberLanguageType? @default(zh_TW)
  createdAt          DateTime?
  updatedAt          DateTime?
  createdBy          User?               @relation("Member_createdBy", fields: [createdById], references: [id])
  createdById        Int?                @map("createdBy")
  updatedBy          User?               @relation("Member_updatedBy", fields: [updatedById], references: [id])
  updatedById        Int?                @map("updatedBy")
  from_Story_author  Story[]             @relation("Story_author")

  @@index([avatar_imageId])
  @@index([createdById])
  @@index([updatedById])
}

model Photo {
  id                       Int       @id @default(autoincrement())
  name                     String    @default("")
  file_filesize            Int?
  file_extension           String?
  file_width               Int?
  file_height              Int?
  file_id                  String?
  urlOriginal              String    @default("")
  createdAt                DateTime?
  updatedAt                DateTime?
  createdBy                User?     @relation("Photo_createdBy", fields: [createdById], references: [id])
  createdById              Int?      @map("createdBy")
  updatedBy                User?     @relation("Photo_updatedBy", fields: [updatedById], references: [id])
  updatedById              Int?      @map("updatedBy")
  from_Member_avatar_image Member[]  @relation("Member_avatar_image")

  @@index([createdById])
  @@index([updatedById])
  @@map("Image")
}

enum StoryFullScreenAdType {
  mobile
  desktop
  all
  none
}

enum StoryStoryTypeType {
  story
  podcast
  video
}

enum MemberLanguageType {
  zh_TW
  zh_CN
  en_US
  en_GB
  ja_JP
  fr_FR
  de_DE
}
